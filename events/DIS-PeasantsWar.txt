country_event = { 
	id = peasants_war.1
	title = "EVTNAME3021"
	desc = "EVTDESC3021"
	picture = ANGRY_MOB_eventPicture
	goto = peasants_revolt_prov
	major = yes
	is_triggered_only = yes
	mean_time_to_happen = { 
		days = 1
	}
	immediate = { 
		set_country_flag = peasant_war
		set_country_flag = had_peasant_war
		hidden_effect = { 
			random_owned_province = { 
				limit = { 
					is_city = yes
					is_in_capital_area = yes
					NOT = { 
						AND = { 
							check_variable = { 
								which = bco
								value = 2
							}
						}
					}
				}
				save_event_target_as = peasants_revolt_prov
				spawn_rebels = { 
					type = mob_rebels
					size = 2
					win = yes
					unrest = 15
				}
			}
		}
	}
	option = { 
		name = "EVTOPTA3021"
		hidden_effect = { 
			if = { 
				limit = { 
					NOT = { 
						stability = -2
					}
				}
				set_variable = { 
					which = ahf
					value = 0
				}
			}
			else = { 
				add_stability = -2
			}
		}
		tooltip = { 
			add_stability = -2
		}
		if = { 
			limit = { 
				is_emperor_of_china = yes
			}
			add_mandate = -10
		}
		add_prestige = -10
	}
}
country_event = { 
	id = peasants_war.2
	title = "EVTNAME3022"
	desc = "EVTDESC3022"
	picture = ANGRY_MOB_eventPicture
	is_triggered_only = yes
	trigger = { 
		NOT = { 
			has_country_flag = peasant_protests
		}
		NOT = { 
			has_country_modifier = NO_ProtectSerfs_S
		}
		NOT = { 
			has_country_modifier = NO_ProtectSerfs_M
		}
		NOT = { 
			has_country_modifier = NO_ProtectSerfs_L
		}
		NOT = { 
			has_country_modifier = NO_Serfs_S
		}
		NOT = { 
			has_country_modifier = NO_Serfs_M
		}
		NOT = { 
			has_country_modifier = NO_Serfs_L
		}
	}
	mean_time_to_happen = { 
		days = 1
	}
	immediate = { 
		set_country_flag = peasant_protests
	}
	option = { 
		name = "EVTOPTA3022"
		ai_chance = { 
			factor = 40
			modifier = { 
				factor = 1.5
				NOT = { 
					AND = { 
						check_variable = { 
							which = asq
							value = 25
						}
					}
				}
			}
			modifier = { 
				factor = 1.2
				NOT = { 
					AND = { 
						check_variable = { 
							which = asq
							value = 50
						}
					}
				}
			}
		}
		random_owned_province = { 
			limit = { 
				is_city = yes
				is_in_capital_area = yes
				NOT = { 
					controlled_by = REB
				}
			}
			spawn_rebels = { 
				type = mob_rebels
				size = 1
				unrest = 10
			}
		}
		capital_scope = { 
			spawn_rebels = { 
				type = mob_rebels
				size = 2
				unrest = 10
			}
		}
		if = { 
			limit = { 
				AND = { 
					check_variable = { 
						which = asn
						value = 65
					}
				}
			}
			add_country_modifier = { 
				name = NO_Serfs_L
				duration = 3650
			}
		}
		else_if = { 
			limit = { 
				AND = { 
					check_variable = { 
						which = asn
						value = 35
					}
				}
			}
			add_country_modifier = { 
				name = NO_Serfs_M
				duration = 3650
			}
		}
		else = { 
			add_country_modifier = { 
				name = NO_Serfs_S
				duration = 3650
			}
		}
		custom_tooltip = NO_Serfs_effect
		hidden_effect = { 
			every_owned_province = { 
				limit = { 
					AND = { 
						check_variable = { 
							which = asn
							value = 0.001
						}
					}
				}
				change_variable = { 
					which = asq
					value = 5
				}
				change_variable = { 
					which = asr
					value = 5
				}
				if = { 
					limit = { 
						AND = { 
							check_variable = { 
								which = asq
								value = 100.001
							}
						}
					}
					set_variable = { 
						which = asq
						value = 100
					}
				}
				else_if = { 
					limit = { 
						NOT = { 
							AND = { 
								check_variable = { 
									which = asq
									value = 0
								}
							}
						}
					}
					set_variable = { 
						which = asq
						value = 0
					}
				}
				set_province_flag = Unrest_Update
			}
		}
		custom_tooltip = POP_NOLoyProv_5
	}
	option = { 
		name = "EVTOPTB3022"
		ai_chance = { 
			factor = 60
			modifier = { 
				factor = 1.5
				AND = { 
					check_variable = { 
						which = asq
						value = 75
					}
				}
			}
		}
		if = { 
			limit = { 
				AND = { 
					check_variable = { 
						which = asn
						value = 65
					}
				}
			}
			add_country_modifier = { 
				name = NO_ProtectSerfs_L
				duration = 3650
			}
		}
		else_if = { 
			limit = { 
				AND = { 
					check_variable = { 
						which = asn
						value = 35
					}
				}
			}
			add_country_modifier = { 
				name = NO_ProtectSerfs_M
				duration = 3650
			}
		}
		else = { 
			add_country_modifier = { 
				name = NO_ProtectSerfs_S
				duration = 3650
			}
		}
		custom_tooltip = NO_ProtectSerfs_effect
		add_adm_power = -25
		hidden_effect = { 
			change_variable = { 
				which = asq
				value = -10
			}
			change_variable = { 
				which = asr
				value = -10
			}
			if = { 
				limit = { 
					AND = { 
						check_variable = { 
							which = asq
							value = 100.001
						}
					}
				}
				set_variable = { 
					which = asq
					value = 100
				}
			}
			else_if = { 
				limit = { 
					NOT = { 
						AND = { 
							check_variable = { 
								which = asq
								value = 0
							}
						}
					}
				}
				set_variable = { 
					which = asq
					value = 0
				}
			}
			set_province_flag = Unrest_Update
		}
		custom_tooltip = POP_NOLoyProv_-10
	}
}
country_event = { 
	id = peasants_war.3
	title = "EVTNAME3023"
	desc = "EVTDESC3023"
	picture = ANGRY_MOB_eventPicture
	goto = heretic_province
	is_triggered_only = yes
	trigger = { 
		NOT = { 
			has_country_flag = religious_revolt
		}
		OR = { 
			religion = catholic
			religion = protestant
			religion = reformed
			religion = hussite
			religion = waldensian
			religion = lollard
			religion = avignonist
			religion = holyleague
		}
		is_religion_enabled = protestant
		any_owned_province = { 
			is_city = yes
			is_in_capital_area = yes
			NOT = { 
				controlled_by = REB
			}
			has_owner_religion = no
			OR = { 
				religion = catholic
				religion = protestant
				religion = reformed
				religion = hussite
			}
		}
	}
	mean_time_to_happen = { 
		days = 1
	}
	immediate = { 
		set_country_flag = religious_revolt
		hidden_effect = { 
			random_owned_province = { 
				limit = { 
					is_city = yes
					is_in_capital_area = yes
					NOT = { 
						controlled_by = REB
					}
					has_owner_religion = no
					OR = { 
						religion = catholic
						religion = protestant
						religion = reformed
						religion = hussite
					}
				}
				save_event_target_as = heretic_province
			}
		}
	}
	option = { 
		name = "EVTOPTA3023"
		ai_chance = { 
			factor = 40
		}
		event_target:heretic_province = { 
			spawn_rebels = { 
				type = mob_rebels
				size = 1
				unrest = 10
			}
		}
		add_mil_power = -50
		if = { 
			limit = { 
				has_disaster = peasant_war
			}
			add_country_modifier = { 
				name = "religious_intolerance"
				duration = -1
				desc = "END_OF_PEASANTS_WAR"
			}
		}
	}
	option = { 
		name = "EVTOPTB3023"
		ai_chance = { 
			factor = 60
		}
		add_dip_power = -50
		reverse_add_opinion = { 
			who = PAP
			modifier = opinion_pope_religious_tolerance
		}
		add_papal_influence = -10
		add_devotion = -25
		if = { 
			limit = { 
				has_disaster = peasant_war
			}
			add_country_modifier = { 
				name = "heretic_tolerance"
				duration = -1
				desc = "END_OF_PEASANTS_WAR"
			}
		}
	}
}
country_event = { 
	id = peasants_war.4
	title = "EVTNAME3024"
	desc = "EVTDESC3024"
	picture = BATTLE_eventPicture
	is_triggered_only = yes
	trigger = { 
		NOT = { 
			has_country_flag = obsolete_forces
		}
		OR = { 
			NOT = { 
				AND = { 
					is_variable_equal = { 
						which = bca
						value = 0
					}
				}
			}
			mil_tech = 25
		}
		NOT = { 
			mil_tech = 40
		}
	}
	mean_time_to_happen = { 
		days = 1
	}
	immediate = { 
		set_country_flag = obsolete_forces
	}
	option = { 
		name = "EVTOPTA3024"
		ai_chance = { 
			factor = 50
		}
		if = { 
			limit = { 
				has_disaster = peasant_war
			}
			add_country_modifier = { 
				name = "obsolete_forces"
				duration = -1
				desc = "END_OF_PEASANTS_WAR"
			}
		}
	}
	option = { 
		name = "EVTOPTB3024"
		ai_chance = { 
			factor = 50
		}
		add_mil_power = -100
		add_army_tradition = -10
		if = { 
			limit = { 
				has_disaster = peasant_war
			}
			add_country_modifier = { 
				name = "support_troops"
				duration = -1
				desc = "END_OF_PEASANTS_WAR"
			}
		}
	}
}
country_event = { 
	id = peasants_war.5
	title = "EVTNAME3025"
	desc = "EVTDESC3025"
	picture = ANGRY_MOB_eventPicture
	goto = rebellion_province
	is_triggered_only = yes
	trigger = { 
		NOT = { 
			has_country_modifier = isolate_rebels
		}
		any_owned_province = { 
			is_city = yes
			is_in_capital_area = yes
			NOT = { 
				controlled_by = REB
			}
			NOT = { 
				AND = { 
					check_variable = { 
						which = bco
						value = 1.5
					}
				}
			}
		}
	}
	mean_time_to_happen = { 
		days = 1
	}
	immediate = { 
		hidden_effect = { 
			random_owned_province = { 
				limit = { 
					is_city = yes
					is_in_capital_area = yes
					NOT = { 
						controlled_by = REB
					}
					NOT = { 
						AND = { 
							check_variable = { 
								which = bco
								value = 1.5
							}
						}
					}
				}
				save_event_target_as = rebellion_province
			}
		}
	}
	option = { 
		name = "EVTOPTA3025"
		ai_chance = { 
			factor = 40
		}
		event_target:rebellion_province = { 
			spawn_rebels = { 
				type = mob_rebels
				size = 2
				unrest = 10
			}
		}
		add_country_modifier = { 
			name = "isolate_rebels"
			duration = 365
		}
	}
	option = { 
		name = "EVTOPTB3025"
		ai_chance = { 
			factor = 60
			modifier = { 
				factor = 0.3
				NOT = { 
					treasury = 50
				}
			}
			modifier = { 
				factor = 0.3
				num_of_loans = 1
			}
		}
		add_treasury = -50
		event_target:rebellion_province = { 
			change_variable = { 
				which = aai
				value = 50
			}
			if = { 
				limit = { 
					NOT = { 
						AND = { 
							check_variable = { 
								which = aai
								value = 1.0
							}
						}
					}
				}
				set_variable = { 
					which = aai
					value = 1.0
				}
			}
			set_province_flag = POP_ChangedWealth
		}
	}
}
country_event = { 
	id = peasants_war.6
	title = "EVTNAME3026"
	desc = "EVTDESC3026"
	picture = ANGRY_MOB_eventPicture
	is_triggered_only = yes
	major = yes
	mean_time_to_happen = { 
		days = 1
	}
	immediate = { 
		clr_country_flag = peasant_war
		disband_rebels = mob_rebels
	}
	option = { 
		name = "EVTOPTA3026"
		if = { 
			limit = { 
				government = monarchy
				is_lesser_in_union = no
			}
			add_legitimacy = 10
		}
		add_prestige = 10
		hidden_effect = { 
			change_variable = { 
				which = ahf
				value = 600
			}
			if = { 
				limit = { 
					AND = { 
						check_variable = { 
							which = ahf
							value = 1200
						}
					}
				}
				if = { 
					limit = { 
						stability = 3
					}
					set_variable = { 
						which = ahf
						value = 1200
					}
				}
				else = { 
					subtract_variable = { 
						which = ahf
						value = 1200
					}
					add_stability = 1
				}
			}
			else_if = { 
				limit = { 
					NOT = { 
						AND = { 
							check_variable = { 
								which = ahf
								value = 0
							}
						}
					}
				}
				if = { 
					limit = { 
						NOT = { 
							stability = -2
						}
					}
					set_variable = { 
						which = ahf
						value = 0
					}
				}
				else = { 
					change_variable = { 
						which = ahf
						value = 1200
					}
					add_stability = -1
				}
			}
			set_variable = { 
				which = ahd
				which = ahf
			}
			divide_variable = { 
				which = ahd
				value = 12
			}
			multiply_variable = { 
				which = ahd
				value = 0.1
			}
			multiply_variable = { 
				which = ahd
				value = 10
			}
			set_variable = { 
				which = lsc
				value = 100
			}
			subtract_variable = { 
				which = lsc
				which = ahd
			}
		}
		custom_tooltip = POP_StabAdd50
		if = { 
			limit = { 
				is_emperor_of_china = yes
			}
			add_mandate = 2.5
		}
		add_country_modifier = { 
			name = recent_peasants_war
			duration = 9125
		}
		clr_country_flag = peasant_protests
		clr_country_flag = religious_revolt
		clr_country_flag = obsolete_forces
		remove_country_modifier = religious_intolerance
		remove_country_modifier = heretic_tolerance
		remove_country_modifier = support_troops
		remove_country_modifier = obsolete_forces
		remove_country_modifier = isolate_rebels
	}
}
